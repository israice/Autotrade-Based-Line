# Autotrade-Based-Line

## Обзор проекта
autotrade-based-line — это система мониторинга данных по криптовалютам, которая получает данные свечей с Binance и обрабатывает их с помощью серии Python-скриптов. Система работает в непрерывном цикле, выполняя каждый скрипт по очереди согласно настройкам в конфигурационном файле.

## Возможности
- Получение актуальных данных по свечам криптовалют с Binance Futures API
- Поддержка бессрочных контрактов (тип рынка PERPETUAL)
- Настраиваемые параметры: торговая пара, интервал и другие
- Последовательное выполнение нескольких скриптов обработки
- Автоматическое управление памятью с помощью сборщика мусора

## Требования
- Python 3.7+
- Необходимые Python-пакеты:
  - PyYAML
  - aiohttp
  - asyncio

## Структура проекта
```
autotrade-based-line/
├── run.py                  # Главный скрипт, управляющий выполнением
├── settings.yaml           # Конфигурационный файл
├── index.html              # Веб-страница для отображения графика свечей
├── candles.json            # JSON-файл с данными свечей для графика
└── CORE/
    ├── AA_fetch_candles.py # Скрипт для получения свечей с Binance
    ├── AA_fetch_candles.json # JSON-вывод полученных данных свечей
    ├── AB_print1.py        # Скрипт обработки 1
    ├── AC_print2.py        # Скрипт обработки 2
    └── AD_print3.py        # Скрипт обработки 3
```


## Установка
1. Клонируйте репозиторий или скачайте файлы проекта
2. Установите необходимые зависимости:
   ```
   pip install pyyaml aiohttp
   ```

## Конфигурация
Отредактируйте файл `settings.yaml` для настройки системы:

```yaml
symbol: XRPUSDT           # Торговая пара
interval: 1m              # Интервал свечей (например, 1m, 5m, 15m, 1h)
market_type: PERPETUAL    # Тип рынка (в данный момент поддерживается только PERPETUAL)
exchange: binance         # Биржа (в данный момент поддерживается только binance)
candles_limit: 2          # Количество свечей для получения
delay: 5                  # Задержка между циклами выполнения (в секундах)
```

## Использование
Запустите главный скрипт для старта системы:

```
python run.py
```

Система будет:
1. Получать данные свечей с Binance согласно настройкам
2. Сохранять данные в `CORE/AA_fetch_candles.json`
3. Последовательно запускать скрипты обработки
4. Ожидать заданную задержку
5. Повторять процесс до прерывания (Ctrl+C)

### Веб-интерфейс
В проекте имеется веб-интерфейс для визуализации данных в виде японских свечей с помощью [lightweight-charts](https://github.com/tradingview/lightweight-charts).

- `index.html` загружает данные из `candles.json` и отображает график.
- `candles.json` должен содержать данные свечей в формате JSON.

#### Запуск локального веб-сервера
Чтобы просмотреть график, запустите локальный сервер в директории проекта. Например, с помощью Python:

```
python -m http.server 8000
```

Затем откройте [http://localhost:8000/index.html](http://localhost:8000/index.html) в вашем браузере.

## Расширение системы
Чтобы добавить дополнительные скрипты обработки:
1. Создайте новый Python-скрипт(ы) в директории `CORE`
2. Добавьте путь(и) к скрипту(ам) в список `files` в `run.py`

## Примечания
- Система корректно обрабатывает прерывания с клавиатуры, завершая текущую итерацию перед выходом
- Память очищается после каждого цикла с помощью сборщика мусора


## Разработка
<details>
  <summary>Журнал DEV</summary>

## v0.0.1
- ДАТА СОЗДАНИЯ ПРОЕКТА: 2025.06.29
- создан run.py, который выполняет чек-лист
- создан settings.yaml со всеми необходимыми настройками
- создан fetch candles.py для получения свечей с binance
- создан clone candles.py для клонирования файла свечей

## v0.0.2
- создан скрипт сравнения цен

## v0.0.3
- Добавлена логика анализа тренда на основе YAML-файла AB_check_trend.py
- Автоматическое выполнение логики по тренду: AC_use_trend.py, ACA_check_green.py, ACB_check_red.py и подскрипты
- Логика сравнения и записи процентного изменения
- Улучшена обработка ошибок и корректное завершение работы

## v0.0.4
- Введён единый цикл запуска всех скриптов через основной run.py
- Добавлено автоматическое измерение времени выполнения цикла
- Реализована очистка памяти после каждого цикла (gc.collect)
- Добавлена обработка сигнала SIGINT для корректного завершения работы
- Вынесены настройки в отдельный YAML-файл и реализована централизованная загрузка настроек
- Введены отдельные скрипты для зелёного/красного тренда и их автоматический запуск в зависимости от значения TREND
- Добавлены сообщения об ошибках при работе с файлами и внешними сервисами
- Улучшена структура backend: разделение на A_GET_DATA, B_CHECK_TREND, Z_CLONE_CANDLE
- Добавлены тестовые скрипты для отладки (test1.py, test2.py и др.)

## ПЛАНЫ НА БУДУЩЕЕ
- создать конфиг для реакции на достижение ценой линии

</details>

<details>
  <summary>Github ШПАРГАЛКА</summary>

## Загрузить последние обновления и заменить локальные файлы
```
git fetch origin; git reset --hard origin/master; git clean -fd  
```

## Посмотреть последние 10 коммитов и выбрать hash
```
git log --oneline -n 10  
```

## Использовать hash для получения нужной версии локально
```
git fetch origin; git checkout master; git reset --hard 1eaef8b; git clean -fdx  
```

## Обновить репозиторий
```
git add .  
git commit -m "Улучшена структура backend: разделение на A_GET_DATA, B_CHECK_TREND, Z_CLONE_CANDLE"  
git push

```


</details>


